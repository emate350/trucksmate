<form action="https://formspree.io/f/xlekavep" method="POST">
  <label for="name">Name:</label>
  <input type="text" id="name" name="name" required><br>

  <label for="email">Email:</label>
  <input type="email" id="email" name="_replyto" required><br>

  <label for="message">Message:</label>
  <textarea id="message" name="message" required></textarea><br>

  <label for="file">File Upload:</label>
  <input type="file" id="file" name="file" onchange="uploadFile()"><br>
  
  <input type="submit" value="Submit">
</form>

<script>
  function uploadFile() {
    var fileInput = document.getElementById("file");
    var file = fileInput.files[0];
    var formData = new FormData();
    formData.append("file", file);
    
    fetch('https://file.io/', {
      method: 'POST',
      body: formData
    })
    .then(response => response.json())
    .then(data => {
      console.log('File uploaded. URL:', data.link);
      fileInput.setAttribute("data-url", data.link);
    })
    .catch(error => {
      console.error('Error uploading file:', error);
    });
  }

  var form = document.querySelector('form');
  form.addEventListener('submit', function(event) {
    event.preventDefault();

    var name = document.getElementById('name').value;
    var email = document.getElementById('email').value;
    var message = document.getElementById('message').value;
    var fileUrl = document.getElementById('file').getAttribute('data-url');
    
    var formData = new FormData();
    formData.append('name', name);
    formData.append('_replyto', email);
    formData.append('message', message);
    formData.append('fileUrl', fileUrl);

    fetch(event.target.action, {
      method: 'POST',
      body: formData,
      headers: {
        'Accept': 'application/json'
      }
    })
    .then(response => {
      if (response.ok) {
        alert('Thank you for your submission!');
      } else {
        alert('Oops! There was a problem submitting your form.');
      }
    })
    .catch(error => {
      console.error('Error submitting form:', error);
      alert('Oops! There was a problem submitting your form.');
    });
  });
</script>
